<!--Peškovs-Artūrs_110_todo-list-V1.html-->

<!DOCTYPE html>
<html>
    <head>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    </head>
<body>
        <!--<h3 class="text-center">Mani darbi</h3>-->
        <div class="card">
            <div class="card-body">
            <h3 class="text-center">Mani darbi</h3><!--class="card-title"-->
                <div class="input-group mb-3">
                    <input type="text" class="form-control" id="lauks" placeholder="Ievadi darbu..." aria-label="Recipient's username" aria-describedby="button-addon2">
                    <button class="btn btn-primary" type="button" onclick="_fukcija()" id="button-addon2">Pievienot</button> <!--class="btn btn-outline-secondary"-->
                </div>
                <ul id="task-list" class="list-group"></ul>
            </div>
        </div>
    </div>
    
   <script>

function datasave() {
    const tasks = [];

    document.querySelectorAll("#task-list li").forEach(li => {
        tasks.push({
            text: li.querySelector("span").textContent,
            done: li.querySelector("span")
                    .classList.contains("text-decoration-line-through")
        });
    });

    localStorage.setItem("tasks", JSON.stringify(tasks));
}

function dataload(){
    const data = JSON.parse(localStorage.getItem("tasks")) || [];

    data.forEach(task => {
        addTask(task.text, task.done);
    });
}

function addTask(text, done = false) {

    const li = document.createElement("li");
    li.classList.add("list-group-item");

    const span = document.createElement("span");
    span.textContent = text;

    if (done) {
        span.classList.add("text-decoration-line-through");
    }

    span.addEventListener("click", function () {
        span.classList.toggle("text-decoration-line-through");
        datasave();
    });

    const btn = document.createElement("button");
    btn.classList.add("btn", "btn-danger", "btn-sm", "float-end");
    btn.textContent = "Dzest";

    btn.addEventListener("click", () => {
        li.remove();
        datasave();
    });

    li.appendChild(span);
    li.appendChild(btn);

    document.getElementById("task-list").appendChild(li);
}

function _fukcija() {
    const vert = document.getElementById("lauks").value;
    if (vert === "") return;

    addTask(vert);
    datasave();

    document.getElementById("lauks").value = "";
}

window.onload = dataload;

</script>

</body>
</html>
