<!--Peškovs-Artūrs_110_todo-list-V1.html-->

<!DOCTYPE html>
<html>
    <head>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    </head>
<body>
        <!--<h3 class="text-center">Mani darbi</h3>-->
        <div class="card">
            <div class="card-body">
            <h3 class="text-center">Mani darbi</h3><!--class="card-title"-->
                <div class="input-group mb-3">
                    <select name= "kirils" id="select" class="form-select">
                        <option value="default">Izvēlēteis prioritāti</option>
                          <option value="Svarīgs">Svarīgs</option>
                          <option value="Vidēji svarīgs">Vidēji svarīgs</option>
                            <option value="Mazsvarīgs">Mazsvarīgs</option>
                    </select>
                    <input type="text" class="form-control" id="lauks" placeholder="Ievadi darbu..." aria-label="Recipient's username" aria-describedby="button-addon2">
                    <button class="btn btn-primary" type="button" onclick="_fukcija()" id="button-addon2">Pievienot</button> <!--class="btn btn-outline-secondary"-->
                </div>
                <ul id="task-list" class="list-group"></ul>
            </div>
        </div>
    
   <script>

function datasave() {
    const tasks = [];

    document.querySelectorAll("#task-list li").forEach(li => {
        tasks.push({
            text: li.querySelector(".task-text").textContent,
            select: li.dataset.select,
            done: li.querySelector(".task-text")
                    .classList.contains("text-decoration-line-through")
        });
    });

    localStorage.setItem("tasks", JSON.stringify(tasks));
}

function dataload(){
    const data = JSON.parse(localStorage.getItem("tasks")) || [];

    data.forEach(task => {
        addTask(task.text, task.done, task.select);
    });
}

function addTask(vert, done = false, select = "Mazsvarīgs") {

    const node = document.createElement("li");
    node.className = "list-group-item d-flex align-items-center justify-content-between";
    node.dataset.select = select;
    
    const left = document.createElement("div");
    left.className = "d-flex align-items-center gap-2";
    
    const badge = document.createElement("span");
    badge.className = "badge";
    
    if (select === "Svarīgs") badge.classList.add("bg-danger");
    if (select === "Vidēji svarīgs") badge.classList.add("bg-warning", "text-dark");
    if (select === "Mazsvarīgs") badge.classList.add("bg-success");
    
    badge.textContent = select.toUpperCase();

    const span = document.createElement("span");
    span.textContent = vert;
    span.className = "task-text";
    
    left.appendChild(badge);
    left.appendChild(span);

    if (done) {
        span.classList.add("text-decoration-line-through");
    }

    span.addEventListener("click", function () {
        span.classList.toggle("text-decoration-line-through");
        datasave();
    });

    const btn = document.createElement("button");
    btn.classList.add("btn", "btn-danger", "btn-sm");
    btn.textContent = "Dzēst";
    btn.onclick = function (e) {
        e.stopPropagation();
        node.remove();
        datasave();
    };
    
    node.appendChild(left);
    node.appendChild(btn);
    document.getElementById("task-list").appendChild(node);
}

function _fukcija() {
    const vert = document.getElementById("lauks").value;
    const svar = document.getElementById("select").value;

    if (vert === "" || svar === "default") return;

    addTask(vert, false, svar);
    datasave();

    document.getElementById("lauks").value = "";
    document.getElementById("select").value = "default";
}

window.onload = dataload;

</script>


</body>
</html>
